(self.webpackChunkphotogallery=self.webpackChunkphotogallery||[]).push([[737],{5737:(W,N,v)=>{v.r(N),v.d(N,{PhotoGalleryAdminModule:()=>A});var x=v(8236),L=v(4313),F=v(655),_=v(4093),b=v(2064),C=v(9843),I=v(729),G=v(8756),B=v(3635),e=v(1209);let M=(()=>{class c{constructor(l,p){this.socialAuthService=l,this.http=p,this.photosEndpoint="clients/64259add18c9f66c78ffe8e6/photos",this.remoteHost="https://photogallery-xiosrv3ggq-ew.a.run.app/",this.remoteHostFilesHub=" https://fileshub-xiosrv3ggq-ew.a.run.app/",this.localHost="http://localhost:8080/",this.uploadEndpoint="clients/123123/files/gcs",this.baseUrl=this.remoteHost+this.photosEndpoint}getPhotos(){return this.http.get(this.baseUrl)}uploadPhoto(l,p){const y=new FormData;return y.append("file",l),this.http.post(this.remoteHostFilesHub+this.uploadEndpoint,y,{reportProgress:!0,observe:"events"})}addOrUpdate(l,p){return l.id?this.updatePhoto(l.id,l,p):this.addPhoto(l,p??"")}addPhoto(l,p){const y=this.toHeaders(p);return this.http.post(this.baseUrl,l,{headers:y})}updatePhoto(l,p,y){const D=this.toHeaders(y??"");return this.http.put(`${this.baseUrl}/${l}`,p,{headers:D})}toHeaders(l){return new I.HttpHeaders({"Content-Type":"application/json",Authorization:"Bearer "+l})}deletePhoto(l){return this.socialAuthService.authState.pipe((0,B.switchMap)(p=>{const y=this.toHeaders(p.idToken);return this.http.delete(`${this.baseUrl}/${l}`,{headers:y})}))}}return c.\u0275fac=function(l){return new(l||c)(e.\u0275\u0275inject(G.SocialAuthService),e.\u0275\u0275inject(I.HttpClient))},c.\u0275prov=e.\u0275\u0275defineInjectable({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();function V(c,d){if(1&c&&e.\u0275\u0275element(0,"img",11),2&c){const l=e.\u0275\u0275nextContext();e.\u0275\u0275property("src",l.previewUrl,e.\u0275\u0275sanitizeUrl)}}function K(c,d){if(1&c&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&c){const l=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",l.fileUploadProgress," ")}}let w=class{constructor(d,l,p,y,D){this.photoService=d,this.socialAuthService=l,this.matDialog=p,this.dialogRef=y,this.photoToUpdate=D,this.photo=D??{},this.photoUpdateForm=new _.FormGroup({id:new _.FormControl(this.photo.id),name:new _.FormControl(this.photo.name),url:new _.FormControl(this.photo.url,[_.Validators.required])})}uploadPhoto(){}fileProgress(d){this.fileData=d.target.files[0],this.photoUpdateForm.patchValue({url:this.fileData.name}),this.preview()}preview(){if(null==this.fileData?.type?.match(/image\/*/))return;const l=new FileReader;l.readAsDataURL(this.fileData),l.onload=p=>{this.previewUrl=l.result}}savePhoto(){this.fileData?this.uploadFileAndSavePhoto(this.fileData):this.photoUpdateForm.valid&&this.photoService.addOrUpdate(this.photoUpdateForm.value).pipe((0,C.untilDestroyed)(this)).subscribe(d=>this.dialogRef.close(d))}uploadFileAndSavePhoto(d,l){this.photoService.uploadPhoto(d,l?.idToken).subscribe(p=>{p.type===I.HttpEventType.UploadProgress?this.fileUploadProgress="Upload progress: "+Math.round(p.loaded/p.total*100)+"%":p.type===I.HttpEventType.Response&&(this.fileUploadProgress="Upload success.",this.uploadedFilePath=p.body?.url,this.photoUpdateForm.patchValue({url:this.uploadedFilePath}),this.photoService.addOrUpdate(this.photoUpdateForm.value,l?.idToken).pipe((0,C.untilDestroyed)(this)).subscribe(y=>this.dialogRef.close(y)))})}};w.\u0275fac=function(d){return new(d||w)(e.\u0275\u0275directiveInject(M),e.\u0275\u0275directiveInject(G.SocialAuthService),e.\u0275\u0275directiveInject(b.MatDialog),e.\u0275\u0275directiveInject(b.MatDialogRef),e.\u0275\u0275directiveInject(b.MAT_DIALOG_DATA))},w.\u0275cmp=e.\u0275\u0275defineComponent({type:w,selectors:[["ng-mf-photo-add-update"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:18,vars:3,consts:[[1,"container-lg","p-5"],[3,"formGroup"],[1,"form-group"],["for","photoName"],["type","text","formControlName","name","id","photoName","placeholder","Enter a name (optional)",1,"form-control"],["for","photoUrl"],["type","text","formControlName","url","id","photoUrl","placeholder","URL",1,"form-control"],["type","file","name","file","id","file",3,"change"],["height","200",3,"src",4,"ngIf"],[4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"click"],["height","200",3,"src"]],template:function(d,l){1&d&&(e.\u0275\u0275elementStart(0,"div",0)(1,"h3"),e.\u0275\u0275text(2,"Add New Photo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"form",1)(4,"div",2)(5,"label",3),e.\u0275\u0275text(6,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"input",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",2)(9,"label",5),e.\u0275\u0275text(10,"URL"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",6),e.\u0275\u0275elementStart(12,"input",7),e.\u0275\u0275listener("change",function(y){return l.fileProgress(y)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,V,1,1,"img",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(14,K,2,1,"div",9),e.\u0275\u0275element(15,"br"),e.\u0275\u0275elementStart(16,"button",10),e.\u0275\u0275listener("click",function(){return l.savePhoto()}),e.\u0275\u0275text(17,"Submit"),e.\u0275\u0275elementEnd()()()),2&d&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",l.photoUpdateForm),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",l.previewUrl),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",l.fileUploadProgress))},dependencies:[_.ReactiveFormsModule,_.\u0275NgNoValidate,_.DefaultValueAccessor,_.NgControlStatus,_.NgControlStatusGroup,_.FormGroupDirective,_.FormControlName,x.NgIf]}),w=(0,F.gn)([(0,C.UntilDestroy)(),(0,F.w6)("design:paramtypes",[M,G.SocialAuthService,b.MatDialog,b.MatDialogRef,Object])],w);let $=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275cmp=e.\u0275\u0275defineComponent({type:c,selectors:[["ng-mf-confirm-delete"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:9,vars:1,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"]],template:function(l,p){1&l&&(e.\u0275\u0275elementStart(0,"h2",0),e.\u0275\u0275text(1,"Are you sure you want to delete this?"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-dialog-content"),e.\u0275\u0275text(3,"This will delete the selected photo."),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-dialog-actions")(5,"button",1),e.\u0275\u0275text(6,"Cancel"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",2),e.\u0275\u0275text(8,"Delete"),e.\u0275\u0275elementEnd()()),2&l&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("mat-dialog-close",!0))},dependencies:[b.MatDialogModule,b.MatDialogClose,b.MatDialogTitle,b.MatDialogContent,b.MatDialogActions]}),c})();var T=v(424);function z(c,d){if(1&c){const l=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tr")(1,"td"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"td")(6,"a",10),e.\u0275\u0275listener("click",function(){const D=e.\u0275\u0275restoreView(l).$implicit,H=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(H.addNewOrEdit(D))}),e.\u0275\u0275element(7,"mat-icon",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(8," \xa0 "),e.\u0275\u0275elementStart(9,"a",12),e.\u0275\u0275listener("click",function(){const D=e.\u0275\u0275restoreView(l).$implicit,H=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(H.delete(D))}),e.\u0275\u0275element(10,"mat-icon",13),e.\u0275\u0275elementEnd()()()}if(2&c){const l=d.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(l.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(l.url)}}let j=class{constructor(d,l){this.matDialog=d,this.photoService=l}addNewOrEdit(d){this.matDialog.open(w,d?{data:d}:{}).afterClosed().pipe((0,C.untilDestroyed)(this)).subscribe(p=>{p&&this.loadData()})}delete(d){this.matDialog.open($).afterClosed().pipe((0,C.untilDestroyed)(this)).subscribe(p=>{p&&this.photoService.deletePhoto(d.id).pipe((0,C.untilDestroyed)(this)).subscribe(()=>this.loadData())})}ngOnInit(){this.loadData()}loadData(){this.photoService.getPhotos().pipe((0,C.untilDestroyed)(this)).subscribe(d=>this.photos=d)}};j.\u0275fac=function(d){return new(d||j)(e.\u0275\u0275directiveInject(b.MatDialog),e.\u0275\u0275directiveInject(M))},j.\u0275cmp=e.\u0275\u0275defineComponent({type:j,selectors:[["ng-mf-photo-list"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:22,vars:1,consts:[[1,"container-lg","pt-5","mt-5"],[1,"table-responsive","pt-5"],[1,"table-wrapper"],[1,"table-title"],[1,"row"],[1,"col-sm-8"],[1,"col-sm-4"],["type","button",1,"btn","btn-info","add-new",3,"click"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["title","Edit","data-toggle","tooltip",1,"add",3,"click"],["aria-hidden","false","aria-label","Example home icon","fontIcon","edit"],["title","Delete","data-toggle","tooltip",1,"add",3,"click"],["aria-hidden","false","aria-label","Example home icon","fontIcon","delete"]],template:function(d,l){1&d&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2"),e.\u0275\u0275text(7,"Photo Gallery"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",6)(9,"button",7),e.\u0275\u0275listener("click",function(){return l.addNewOrEdit()}),e.\u0275\u0275text(10,"Add New"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(11,"table",8)(12,"thead")(13,"tr")(14,"th"),e.\u0275\u0275text(15,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th"),e.\u0275\u0275text(17,"Url"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th"),e.\u0275\u0275text(19,"Actions"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(20,"tbody"),e.\u0275\u0275template(21,z,11,2,"tr",9),e.\u0275\u0275elementEnd()()()()()),2&d&&(e.\u0275\u0275advance(21),e.\u0275\u0275property("ngForOf",l.photos))},dependencies:[x.NgFor,T.MatIconModule,T.MatIcon]}),j=(0,F.gn)([(0,C.UntilDestroy)(),(0,F.w6)("design:paramtypes",[b.MatDialog,M])],j);const J=[{path:"add-update",component:w},{path:"",component:j}];let Q=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275mod=e.\u0275\u0275defineNgModule({type:c}),c.\u0275inj=e.\u0275\u0275defineInjector({imports:[L.RouterModule.forChild(J),L.RouterModule]}),c})(),A=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275mod=e.\u0275\u0275defineNgModule({type:c}),c.\u0275inj=e.\u0275\u0275defineInjector({imports:[x.CommonModule,_.ReactiveFormsModule,T.MatIconModule,b.MatDialogModule,Q,w,j,$]}),c})()},655:(W,N,v)=>{function b(t,n,o,r){var s,a=arguments.length,i=a<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,n,o,r);else for(var f=t.length-1;f>=0;f--)(s=t[f])&&(i=(a<3?s(i):a>3?s(n,o,i):s(n,o))||i);return a>3&&i&&Object.defineProperty(n,o,i),i}function M(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)}function V(t,n,o,r){return new(o||(o=Promise))(function(i,s){function f(h){try{u(r.next(h))}catch(g){s(g)}}function P(h){try{u(r.throw(h))}catch(g){s(g)}}function u(h){h.done?i(h.value):function a(i){return i instanceof o?i:new o(function(s){s(i)})}(h.value).then(f,P)}u((r=r.apply(t,n||[])).next())})}function A(t){return this instanceof A?(this.v=t,this):new A(t)}function c(t,n,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,r=o.apply(t,n||[]),i=[];return a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a;function s(m){r[m]&&(a[m]=function(S){return new Promise(function(E,O){i.push([m,S,E,O])>1||f(m,S)})})}function f(m,S){try{!function P(m){m.value instanceof A?Promise.resolve(m.value.v).then(u,h):g(i[0][2],m)}(r[m](S))}catch(E){g(i[0][3],E)}}function u(m){f("next",m)}function h(m){f("throw",m)}function g(m,S){m(S),i.shift(),i.length&&f(i[0][0],i[0][1])}}function l(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function T(t){var n="function"==typeof Symbol&&Symbol.iterator,o=n&&t[n],r=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o);function r(i){o[i]=t[i]&&function(s){return new Promise(function(f,P){!function a(i,s,f,P){Promise.resolve(P).then(function(u){i({value:u,done:f})},s)}(f,P,(s=t[i](s)).done,s.value)})}}}v.d(N,{FC:()=>c,KL:()=>l,gn:()=>b,mG:()=>V,qq:()=>A,w6:()=>M})}}]);